{"version":3,"file":"editor.js","sources":["../src/pages/editor.tsx"],"sourcesContent":["import CircularProgress from \"@mui/material/CircularProgress\";\nimport Container from \"@mui/material/Container\";\nimport { join } from \"path-browserify\";\nimport React, { Fragment, lazy, ReactChild, useMemo } from \"react\";\nimport { Route, Routes, useParams } from \"react-router-dom\";\nimport { combineLatest, map } from \"rxjs\";\nimport { useObservableAndState } from \"../hooks/use_observable_and_state\";\nimport { projects$ } from \"../store/contents\";\nimport { documents$ } from \"../store/documents\";\nconst DocFetcher = lazy(() => import(\"../components/doc_fetcher\"));\nimport { useComponentContext } from \"../hooks/use_component_context\";\n\nconst DocumentEditor = () => {\n  const { MarkdownEditor } = useComponentContext();\n  const params = useParams();\n  const [document] = useObservableAndState(\n    (input$) => {\n      return combineLatest([input$, documents$]).pipe(\n        map(([input, documents]) => {\n          return documents.get(input[0]?.contentSlug);\n        })\n      );\n    },\n    [params]\n  );\n  const shouldHaveDocument = !!params.contentSlug;\n  const path: string = useMemo(() => {\n    if (document) {\n      return join(projects$.value.get(params.projectSlug).path, document.path);\n    }\n    return undefined;\n  }, [document, params]);\n  return (\n    <>\n      {shouldHaveDocument && !document ? (\n        <CircularProgress></CircularProgress>\n      ) : (\n        <MarkdownEditor\n          key={shouldHaveDocument ? document.mdx : \"# hello world\"}\n          initial={shouldHaveDocument ? document.mdx : \"# hello world\"}\n          path={path}\n        ></MarkdownEditor>\n      )}\n    </>\n  );\n};\n\nconst Layout = ({ children }: { children: ReactChild }) => {\n  const { Navbar, MarkdownEditor } = useComponentContext();\n  return (\n    <Fragment>\n      <DocFetcher mode=\"editor\"></DocFetcher>\n      <Navbar></Navbar>\n      <Container\n        sx={{\n          marginTop: 3,\n          marginBottom: 3,\n          flex: \"auto\",\n          display: \"flex\",\n          maxWidth: \"100% !important\",\n        }}\n      >\n        {children}\n      </Container>\n    </Fragment>\n  );\n};\n\nexport const Editor = () => {\n  return (\n    <Routes>\n      <Route\n        path=\"/:projectSlug\"\n        element={\n          <Layout>\n            <DocumentEditor></DocumentEditor>\n          </Layout>\n        }\n      ></Route>\n      <Route\n        path=\"/:projectSlug/:contentSlug\"\n        element={\n          <Layout>\n            <DocumentEditor></DocumentEditor>\n          </Layout>\n        }\n      ></Route>\n      <Route\n        path=\"/\"\n        element={\n          <Layout>\n            <DocumentEditor></DocumentEditor>\n          </Layout>\n        }\n      ></Route>\n    </Routes>\n  );\n};\nexport default Editor;\n"],"names":["DocFetcher","lazy","DocumentEditor","MarkdownEditor","useComponentContext","params","useParams","document","useObservableAndState","input$","combineLatest","documents$","pipe","map","input","documents","get","contentSlug","shouldHaveDocument","path","useMemo","join","projects$","value","projectSlug","undefined","mdx","Layout","children","Navbar","Fragment","marginTop","marginBottom","flex","display","maxWidth","Editor"],"mappings":";;;;;;;AASA,MAAMA,aAAaC,KAAK,MAAM,OAAO;AAGrC,MAAMC,iBAAiB,MAAM;QACrB;AAAA,IAAEC;AAAAA,MAAmBC;QACrBC,SAASC;QACT,CAACC,YAAYC,sBAChBC,YAAW;WACHC,cAAc,CAACD,QAAQE,aAAaC,KACzCC,IAAI,CAAC,CAACC,OAAOC,eAAe;;aACnBA,UAAUC,IAAIF,YAAM,OAANA,mBAAUG;AAAAA;AAAAA,KAIrC,CAACZ;QAEGa,qBAAqB,CAAC,CAACb,OAAOY;QAC9BE,OAAeC,QAAQ,MAAM;QAC7Bb,UAAU;aACLc,oBAAKC,UAAUC,MAAMP,IAAIX,OAAOmB,aAAaL,MAAMZ,SAASY;AAAAA;WAE9DM;AAAAA,KACN,CAAClB,UAAUF;;cAGTa,sBAAsB,CAACX,+BACrB,4CAEA;MAEC,SAASW,qBAAqBX,SAASmB,MAAM;AAAA,MAC7C;AAAA,OAFKR,qBAAqBX,SAASmB,MAAM;AAAA;AAAA;AASnD,MAAMC,SAAS,CAAC;AAAA,EAAEC;AAAAA,MAAyC;QACnD;AAAA,IAAEC;AAAAA,IAAQ1B;AAAAA,MAAmBC;8BAEhC0B;mCACE;MAAW,MAAK;AAAA,4BAChB,iCACA;MACC,IAAI;AAAA,QACFC,WAAW;AAAA,QACXC,cAAc;AAAA,QACdC,MAAM;AAAA,QACNC,SAAS;AAAA,QACTC,UAAU;AAAA;AAAA;;;;MASPC,SAAS,MAAM;8BAEvB;mCACE;MACC,MAAK;AAAA,MACL,6BACG;sCACE;;4BAIN;MACC,MAAK;AAAA,MACL,6BACG;sCACE;;4BAIN;MACC,MAAK;AAAA,MACL,6BACG;sCACE;;;;;;"}