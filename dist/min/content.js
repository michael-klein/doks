var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t));import{d as default_1$2}from"./Favorite.js";import{c as createSvgIcon,i as interopRequireDefault,r as require$$2,d as default_1$1,B as Box,H as modifyDocument,a as documents$}from"./documents.js";import*as React from"react";import React__default,{memo,useMemo,useRef,useCallback,useEffect}from"react";import{combineLatest}from"rxjs";import{map}from"rxjs/operators";import{h as htmdx,I as IconButton,M as MarkdownRenderer}from"./markdown_renderer.js";import{u as useParams,L as Link}from"./doks.js";import{m as generateUtilityClass,n as generateUtilityClasses,o as styled,q as useThemeProps,h as _objectWithoutPropertiesLoose,_ as _extends,r as composeClasses,j as jsx,l as clsx,d as jsxs,F as Fragment}from"./main.js";import{G as Grid}from"./Button.js";import{u as useObservableState,a as useObservable}from"./use-observable-state.js";import{C as Card}from"./Card.js";import{C as CardHeader}from"./CardHeader.js";import"./index.js";import"react-dom";function getCardContentUtilityClass(e){return generateUtilityClass("MuiCardContent",e)}generateUtilityClasses("MuiCardContent",["root"]);const _excluded=["className","component"],useUtilityClasses=e=>{const{classes:t}=e;return composeClasses({root:["root"]},getCardContentUtilityClass,t)},CardContentRoot=styled("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),CardContent=React.forwardRef((function(e,t){const r=useThemeProps({props:e,name:"MuiCardContent"}),{className:s,component:o="div"}=r,a=_objectWithoutPropertiesLoose(r,_excluded),n=_extends({},r,{component:o}),i=useUtilityClasses(n);return jsx(CardContentRoot,_extends({as:o,className:clsx(i.root,s),ownerState:n,ref:t},a))}));var CardContent$1=CardContent;const formatDate=e=>new Date(e).toLocaleString();var SubdirectoryArrowRight={},_interopRequireDefault=interopRequireDefault.exports;Object.defineProperty(SubdirectoryArrowRight,"__esModule",{value:!0});var default_1=SubdirectoryArrowRight.default=void 0,_createSvgIcon=_interopRequireDefault(createSvgIcon),_jsxRuntime=require$$2,_default=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"m19 15-6 6-1.42-1.42L15.17 16H4V4h2v10h9.17l-3.59-3.58L13 9l6 6z"}),"SubdirectoryArrowRight");default_1=SubdirectoryArrowRight.default=_default;var removeMarkdown=function(e,t){(t=t||{}).listUnicodeChar=!!t.hasOwnProperty("listUnicodeChar")&&t.listUnicodeChar,t.stripListLeaders=!t.hasOwnProperty("stripListLeaders")||t.stripListLeaders,t.gfm=!t.hasOwnProperty("gfm")||t.gfm,t.useImgAltText=!t.hasOwnProperty("useImgAltText")||t.useImgAltText;var r=e||"";r=r.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*$/gm,"");try{t.stripListLeaders&&(r=t.listUnicodeChar?r.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,t.listUnicodeChar+" $1"):r.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,"$1")),t.gfm&&(r=r.replace(/\n={2,}/g,"\n").replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/`{3}.*\n/g,"")),r=r.replace(/<[^>]*>/g,"").replace(/^[=\-]{2,}\s*$/g,"").replace(/\[\^.+?\](\: .*?$)?/g,"").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,t.useImgAltText?"$1":"").replace(/\[(.*?)\][\[\(].*?[\]\)]/g,"$1").replace(/^\s{0,3}>\s?/g,"").replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/^(\n)?\s{0,}#{1,6}\s+| {0,}(\n)?\s{0,}#{0,} {0,}(\n)?\s{0,}$/gm,"$1$2$3").replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/\n{2,}/g,"\n\n")}catch(t){return console.error(t),e}return r};class ErrorBoundary extends React__default.Component{constructor(e){super(e),this.state={hasError:!1,error:""}}componentDidCatch(e,t){}static getDerivedStateFromError(e){return{hasError:!0,error:e.message}}render(){return this.state.hasError?(console.error("toc error",this.state.error),jsxs(Fragment,{children:[jsx("h1",{children:"MDX error:"}),jsx("div",{children:this.state.error})]})):this.props.children}}const TOCList=default_1$1("ul")({listStyle:"none",margin:0,padding:10,paddingLeft:0,lineHeight:"1.3em",maxHeight:"calc(60vh)",overflowY:"auto"}),TOCListItem=default_1$1("li")({fontSize:".9em","a,a:hover,a:link,a:active":{color:"inherit",textDecoration:"none",textAlign:"left"},"a:hover":{textDecoration:"underline"}}),getListItem=e=>t=>{const r=useParams(),s=useRef();return jsxs(TOCListItem,{sx:{marginLeft:10*(e-1)+"px",display:"flex"},children:[jsx(Box,{children:jsx(default_1,{sx:{fontSize:".8em",marginRight:".2em"},className:"sub-icon"})}),jsx(Box,{children:jsx(Link,__spreadProps(__spreadValues({},t),{ref:s,to:`/docs/${r.projectSlug}/${r.contentSlug}/${t.index}`}))})]})},TOC=memo((({mdx:e})=>{const t=useMemo((()=>null==e?void 0:e.replace(/(<([^>]+)>)/gi,"").split("\n").filter((e=>e.startsWith("#"))).map((e=>{for(let t=0;t<e.length;t++)if("#"!==e.charAt(t))return e.substr(0,t-1)+removeMarkdown(e.substr(t));return e})).join("\n")),[e]);let r=0,s=0;return jsx(Fragment,{children:void 0!==t?jsx(TOCList,{children:htmdx(t,React__default.createElement,{components:{h1:getListItem(1),h2:getListItem(2),h3:getListItem(3),h4:getListItem(4),h6:getListItem(6),h7:getListItem(7),h8:getListItem(8),h10:getListItem(10)},jsxTransforms:[(e,t,o)=>(t||(t={}),e.startsWith("h")&&(t.index=s,s++),t.key=r++,[e,t,o])]})}):jsx(Fragment,{})})})),Wrapper=default_1$1(Box)((({theme:e})=>__spreadProps(__spreadValues({},e.typography.body1),{width:"220px"}))),Header=default_1$1("h1")({fontSize:"1em",marginBottom:"-.7em",fontWeight:"bold"}),TableOfContents=({mdx:e})=>jsxs(Wrapper,{children:[jsx(Header,{children:"Table of contents"}),jsx(ErrorBoundary,{children:jsx(TOC,{mdx:e})},"toc-"+e)]}),ContentWrapper=default_1$1(Grid)((({theme:e})=>({display:"flex",alignItems:"start",flexDirection:"row",[e.breakpoints.down("sm")]:{maxWidth:"100%",flexBasis:"initial"}}))),Content=()=>{var e;const t=useParams(),r=useObservableState(useObservable((e=>combineLatest(e,documents$).pipe(map((([e,t])=>t.get(e[0].contentSlug))))),[t])),s=useCallback((()=>{modifyDocument(__spreadProps(__spreadValues({},r),{isFavourite:!r.isFavourite}))}),[r]),o=useRef(),a=useRef(),n=useCallback((()=>{var e;if(void 0!==t.headingIndex){const r=null==(e=o.current)?void 0:e.querySelector(`#heading-${t.headingIndex}`);r&&(clearTimeout(a.current),a.current=setInterval((()=>{requestAnimationFrame((()=>{const e=window.document.body.getBoundingClientRect().top,t=r.getBoundingClientRect().top-e-60;t>0&&(window.scrollTo({top:t,behavior:"smooth"}),clearTimeout(a.current))}))}),100))}}),[t.headingIndex]);return useEffect((()=>(window.scrollTo(0,0),()=>{clearTimeout(a.current)})),[t.contentSlug]),jsxs(ContentWrapper,{item:!0,xs:9,children:[jsxs(Card,{elevation:2,sx:{padding:2,textAlign:"justify",overflowX:"auto"},children:[r&&jsx(CardHeader,{action:jsx(IconButton,{"aria-label":"favourite",onClick:s,children:jsx(default_1$2,{sx:{color:r.isFavourite&&"red"}})}),title:r.name,subheader:(i=r.lastModified,new Date(i).toLocaleString())}),jsx(CardContent$1,{ref:o,sx:{display:"block",overflow:"auto"},children:jsx(MarkdownRenderer,{mdx:null==r?void 0:r.mdx,onAfterRender:n})})]}),((null==(e=null==r?void 0:r.mdx)?void 0:e.match(/#/g))||[]).length>1&&jsx(Card,{elevation:2,sx:{textAlign:"justify",overflowX:"auto",marginTop:"20px",marginBottom:"20px",marginLeft:"-10px",overflow:"visible",position:"sticky",padding:"10px",paddingRight:0,top:"100px"},children:jsx(TableOfContents,{mdx:null==r?void 0:r.mdx})})]});var i};export{Content,Content as default};