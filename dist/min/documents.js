var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))__hasOwnProp.call(t,n)&&__defNormalProp(e,n,t[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(t))__propIsEnum.call(t,n)&&__defNormalProp(e,n,t[n]);return e};import{BehaviorSubject}from"rxjs";function n(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function t(e){return!!e&&!!e[Q]}function r(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Z}(e)||Array.isArray(e)||!!e[L]||!!e.constructor[L]||s(e)||v(e))}function i(e,t,n){void 0===n&&(n=!1),0===o(e)?(n?Object.keys:nn)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function o(e){var t=e[Q];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:s(e)?2:v(e)?3:0}function u(e,t){return 2===o(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){return 2===o(e)?e.get(t):e[t]}function f(e,t,n){var r=o(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function c(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function s(e){return X&&e instanceof Map}function v(e){return q&&e instanceof Set}function p(e){return e.o||e.t}function l(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=tn(e);delete t[Q];for(var n=nn(t),r=0;r<n.length;r++){var o=n[r],u=t[o];!1===u.writable&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(t[o]={configurable:!0,writable:!0,enumerable:u.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function d(e,n){return void 0===n&&(n=!1),y(e)||t(e)||!r(e)||(o(e)>1&&(e.set=e.add=e.clear=e.delete=h),Object.freeze(e),n&&i(e,(function(e,t){return d(t,!0)}),!0)),e}function h(){n(2)}function y(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function b(e){var t=rn[e];return t||n(18,e),t}function m(e,t){rn[e]||(rn[e]=t)}function _(){return U}function j(e,t){t&&(b("Patches"),e.u=[],e.s=[],e.v=t)}function O(e){g(e),e.p.forEach(S),e.p=null}function g(e){e===U&&(U=e.l)}function w(e){return U={p:[],l:U,h:e,m:!0,_:0}}function S(e){var t=e[Q];0===t.i||1===t.i?t.j():t.O=!0}function P(e,t){t._=t.p.length;var o=t.p[0],u=void 0!==e&&e!==o;return t.h.g||b("ES5").S(t,e,u),u?(o[Q].P&&(O(t),n(4)),r(e)&&(e=M(t,e),t.l||x(t,e)),t.u&&b("Patches").M(o[Q],e,t.u,t.s)):e=M(t,o,[]),O(t),t.u&&t.v(t.u,t.s),e!==H?e:void 0}function M(e,t,n){if(y(t))return t;var r=t[Q];if(!r)return i(t,(function(o,u){return A(e,r,t,o,u,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return x(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=l(r.k):r.o;i(3===r.i?new Set(o):o,(function(t,u){return A(e,r,o,t,u,n)})),x(e,o,!1),n&&e.u&&b("Patches").R(r,n,e.u,e.s)}return r.o}function A(e,n,o,i,a,c){if(t(a)){var s=M(e,a,c&&n&&3!==n.i&&!u(n.D,i)?c.concat(i):void 0);if(f(o,i,s),!t(s))return;e.m=!1}if(r(a)&&!y(a)){if(!e.h.F&&e._<1)return;M(e,a),n&&n.A.l||x(e,a)}}function x(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&d(t,n)}function z(e,t){var n=e[Q];return(n?p(n):e)[t]}function I(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function k(e){e.P||(e.P=!0,e.l&&k(e.l))}function E(e){e.o||(e.o=l(e.t))}function R(e,t,n){var r=s(t)?b("MapSet").N(t,n):v(t)?b("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:_(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=r,u=en;n&&(o=[r],u=on);var i=Proxy.revocable(o,u),a=i.revoke,c=i.proxy;return r.k=c,r.j=a,c}(t,n):b("ES5").J(t,n);return(n?n.A:_()).p.push(r),r}function D(e){return t(e)||n(22,e),function e(t){if(!r(t))return t;var n,u=t[Q],c=o(t);if(u){if(!u.P&&(u.i<4||!b("ES5").K(u)))return u.t;u.I=!0,n=F(t,c),u.I=!1}else n=F(t,c);return i(n,(function(t,r){u&&a(u.t,t)===r||f(n,t,e(r))})),3===c?new Set(n):n}(e)}function F(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return l(e)}function C(){function e(e,t){function n(){this.constructor=e}a(e,t),e.prototype=(n.prototype=t.prototype,new n)}function t(e){e.o||(e.D=new Map,e.o=new Map(e.t))}function o(e){e.o||(e.o=new Set,e.t.forEach((function(t){if(r(t)){var n=R(e.A.h,t,e);e.p.set(t,n),e.o.add(n)}else e.o.add(t)})))}function u(e){e.O&&n(3,JSON.stringify(p(e)))}var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},c=function(){function n(e,t){return this[Q]={i:2,l:t,A:t?t.A:_(),P:!1,I:!1,o:void 0,D:void 0,t:e,k:this,C:!1,O:!1},this}e(n,Map);var o=n.prototype;return Object.defineProperty(o,"size",{get:function(){return p(this[Q]).size}}),o.has=function(e){return p(this[Q]).has(e)},o.set=function(e,n){var r=this[Q];return u(r),p(r).has(e)&&p(r).get(e)===n||(t(r),k(r),r.D.set(e,!0),r.o.set(e,n),r.D.set(e,!0)),this},o.delete=function(e){if(!this.has(e))return!1;var n=this[Q];return u(n),t(n),k(n),n.D.set(e,!1),n.o.delete(e),!0},o.clear=function(){var e=this[Q];u(e),p(e).size&&(t(e),k(e),e.D=new Map,i(e.t,(function(t){e.D.set(t,!1)})),e.o.clear())},o.forEach=function(e,t){var n=this;p(this[Q]).forEach((function(r,o){e.call(t,n.get(o),o,n)}))},o.get=function(e){var n=this[Q];u(n);var o=p(n).get(e);if(n.I||!r(o))return o;if(o!==n.t.get(e))return o;var i=R(n.A.h,o,n);return t(n),n.o.set(e,i),i},o.keys=function(){return p(this[Q]).keys()},o.values=function(){var e,t=this,n=this.keys();return(e={})[V]=function(){return t.values()},e.next=function(){var e=n.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},o.entries=function(){var e,t=this,n=this.keys();return(e={})[V]=function(){return t.entries()},e.next=function(){var e=n.next();if(e.done)return e;var r=t.get(e.value);return{done:!1,value:[e.value,r]}},e},o[V]=function(){return this.entries()},n}(),s=function(){function t(e,t){return this[Q]={i:3,l:t,A:t?t.A:_(),P:!1,I:!1,o:void 0,t:e,k:this,p:new Map,O:!1,C:!1},this}e(t,Set);var n=t.prototype;return Object.defineProperty(n,"size",{get:function(){return p(this[Q]).size}}),n.has=function(e){var t=this[Q];return u(t),t.o?!!t.o.has(e)||!(!t.p.has(e)||!t.o.has(t.p.get(e))):t.t.has(e)},n.add=function(e){var t=this[Q];return u(t),this.has(e)||(o(t),k(t),t.o.add(e)),this},n.delete=function(e){if(!this.has(e))return!1;var t=this[Q];return u(t),o(t),k(t),t.o.delete(e)||!!t.p.has(e)&&t.o.delete(t.p.get(e))},n.clear=function(){var e=this[Q];u(e),p(e).size&&(o(e),k(e),e.o.clear())},n.values=function(){var e=this[Q];return u(e),o(e),e.o.values()},n.entries=function(){var e=this[Q];return u(e),o(e),e.o.entries()},n.keys=function(){return this.values()},n[V]=function(){return this.values()},n.forEach=function(e,t){for(var n=this.values(),r=n.next();!r.done;)e.call(t,r.value,r.value,this),r=n.next()},t}();m("MapSet",{N:function(e,t){return new c(e,t)},T:function(e,t){return new s(e,t)}})}var G,U,W="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),X="undefined"!=typeof Map,q="undefined"!=typeof Set,B="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,H=W?Symbol.for("immer-nothing"):((G={})["immer-nothing"]=!0,G),L=W?Symbol.for("immer-draftable"):"__$immer_draftable",Q=W?Symbol.for("immer-state"):"__$immer_state",V="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",Z=""+Object.prototype.constructor,nn="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,tn=Object.getOwnPropertyDescriptors||function(e){var t={};return nn(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},rn={},en={get:function(e,t){if(t===Q)return e;var n,o,i,a=p(e);if(!u(a,t))return n=e,(i=I(a,t))?"value"in i?i.value:null===(o=i.get)||void 0===o?void 0:o.call(n.k):void 0;var c=a[t];return e.I||!r(c)?c:c===z(e.t,t)?(E(e),e.o[t]=R(e.A.h,c,e)):c},has:function(e,t){return t in p(e)},ownKeys:function(e){return Reflect.ownKeys(p(e))},set:function(e,t,n){var r=I(p(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var o=z(p(e),t),i=null==o?void 0:o[Q];if(i&&i.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(c(n,o)&&(void 0!==n||u(e.t,t)))return!0;E(e),k(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==z(e.t,t)||t in e.t?(e.D[t]=!1,E(e),k(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=p(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){n(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){n(12)}},on={};i(en,(function(e,t){on[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),on.deleteProperty=function(e,t){return en.deleteProperty.call(this,e[0],t)},on.set=function(e,t,n){return en.set.call(this,e[0],t,n,e[0])};var un=function(){function e(e){var t=this;this.g=B,this.F=!0,this.produce=function(e,o,u){if("function"==typeof e&&"function"!=typeof o){var i=o;o=e;var a=t;return function(e){var t=this;void 0===e&&(e=i);for(var n=arguments.length,r=Array(n>1?n-1:0),u=1;u<n;u++)r[u-1]=arguments[u];return a.produce(e,(function(e){var n;return(n=o).call.apply(n,[t,e].concat(r))}))}}var c;if("function"!=typeof o&&n(6),void 0!==u&&"function"!=typeof u&&n(7),r(e)){var s=w(t),f=R(t,e,void 0),l=!0;try{c=o(f),l=!1}finally{l?O(s):g(s)}return"undefined"!=typeof Promise&&c instanceof Promise?c.then((function(e){return j(s,u),P(e,s)}),(function(e){throw O(s),e})):(j(s,u),P(c,s))}if(!e||"object"!=typeof e){if((c=o(e))===H)return;return void 0===c&&(c=e),t.F&&d(c,!0),c}n(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),u=1;u<r;u++)o[u-1]=arguments[u];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(o))}))}:[t.produce(e,n,(function(e,t){r=e,o=t})),r,o];var r,o},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var o=e.prototype;return o.createDraft=function(e){r(e)||n(8),t(e)&&(e=D(e));var o=w(this),u=R(this,e,void 0);return u[Q].C=!0,g(o),u},o.finishDraft=function(e,t){var n=(e&&e[Q]).A;return j(n,t),P(void 0,n)},o.setAutoFreeze=function(e){this.F=e},o.setUseProxies=function(e){e&&!B&&n(20),this.g=e},o.applyPatches=function(e,n){var r;for(r=n.length-1;r>=0;r--){var o=n[r];if(0===o.path.length&&"replace"===o.op){e=o.value;break}}var u=b("Patches").$;return t(e)?u(e,n):this.produce(e,(function(e){return u(e,n.slice(r+1))}))},e}(),an=new un,fn=an.produce;an.produceWithPatches.bind(an),an.setAutoFreeze.bind(an),an.setUseProxies.bind(an),an.applyPatches.bind(an),an.createDraft.bind(an),an.finishDraft.bind(an);class ValueSubject extends BehaviorSubject{next(e){this.value!==e&&super.next(e)}}function WorkerWrapper(){return new Worker("/assets/document_worker.4dcf3d91.js",{type:"module"})}C();const projects$=new ValueSubject(new Map),contents$=new ValueSubject(new Map),addOrUpdateProject=e=>{projects$.next(fn(projects$.value,(t=>{t.set(e.slug,e)})))},updateContents=(e,t)=>{contents$.next(fn(contents$.value,(n=>{n.get(t).set(e.slug,__spreadValues(__spreadValues({},n.get(t).get(e.slug)),e))})))},removeContents=(e,t)=>{contents$.next(fn(contents$.value,(n=>{var r;null==(r=n.get(t))||r.delete(e)})))},addOrUpdateContents=(e,t)=>{contents$.next(fn(contents$.value,(n=>{n.has(t)||n.set(t,new Map),n.get(t).set(e.slug,e)})))},addOrUpdateManyContents=(e,t)=>{contents$.next(fn(contents$.value,(n=>{n.has(t)||n.set(t,new Map),e.forEach((e=>{n.get(t).set(e.slug,e)}))})))},documents$=new ValueSubject(new Map),queuedDocuments$=new ValueSubject({docs:new Map,order:[]}),fetchingDocuments$=new ValueSubject(new Set),CACHE_PREFEX="doks-cache";let flushCache=!1;window.flushCacheOnReload=()=>{flushCache=!0};const cachedDocuments=new Map,getCachedDocument=e=>{if(cachedDocuments.has(e))return cachedDocuments.get(e);const t=localStorage.getItem("doks-cache"+e);if(t){const n=JSON.parse(t);return cachedDocuments.set(e,n),n}},modifyDocument=e=>{documents$.next(fn(documents$.value,(t=>{var n;const r=__spreadValues(__spreadValues({},null!=(n=documents$.value.get(e.slug))?n:{}),e);var o,u;r.name===r.path&&r.mdx.trim().startsWith("#")&&(r.name=r.mdx.split("\n")[0].replace("#","").trim()),o={slug:r.slug,name:r.name},u=r.projectSlug,contents$.next(fn(contents$.value,(e=>{e.get(u).set(o.slug,__spreadValues(__spreadValues({},e.get(u).get(o.slug)),o))}))),t.set(e.slug,r)})))},cacheDocument=e=>{flushCache||localStorage.setItem("doks-cache"+e.slug,JSON.stringify(e))};window.onunload=()=>{flushCache&&localStorage.clear(),documents$.value.forEach((e=>cacheDocument(e)))};const getLastModified=async e=>{try{return await fetch(e,{method:"HEAD"}).then((e=>{if(e.ok)return e.headers.get("Last-Modified");throw new Error("does not exist")}))}catch(e){return!1}},workerPool=[],spawnWorker=()=>{const e=new WorkerWrapper;return e.onmessage=t=>{switch(t.data[0]){case"fetch_done":workerPool.push(e);const n=t.data[1];modifyDocument(n),fetchingDocuments$.next(fn(fetchingDocuments$.value,(e=>{e.delete(n.slug)})))}},e},sendToWorker=(e,t)=>{var u;(null!=(n=workerPool.shift())?n:spawnWorker()).postMessage([e,t])},fetchDocument=async e=>{const t=projects$.value.get(e.projectSlug);fetchingDocuments$.next(fn(fetchingDocuments$.value,(t=>{t.add(e.slug)})));const n=getCachedDocument(e.slug);var r,o,u;n&&n.lastModified===e.lastModified?(modifyDocument(n),fetchingDocuments$.next(fn(fetchingDocuments$.value,(t=>{t.delete(e.slug)})))):(r="fetch",o={contents:__spreadValues({},e),projectRoot:t.root},(null!=(u=workerPool.shift())?u:spawnWorker()).postMessage([r,o]))},MAX_QUEUE=50,shiftQueue=()=>{if(queuedDocuments$.value.order.length>0&&queuedDocuments$.value.docs.size<50){let e;queuedDocuments$.next(fn(queuedDocuments$.value,(t=>{const n=t.order.shift();e=queuedDocuments$.value.docs.get(n),t.docs.delete(n);const r=t.order.indexOf(n);r>-1&&t.order.splice(r,1)}))),fetchDocument(e)}};fetchingDocuments$.subscribe(shiftQueue);const queueDocument=(e,t=!1)=>{documents$.value.has(e.slug)||fetchingDocuments$.value.has(e.slug)||(queuedDocuments$.next(fn(queuedDocuments$.value,(n=>{if(n.docs.set(e.slug,e),t){const t=n.order.indexOf(e.slug);t>-1&&n.order.splice(t,1),n.order.unshift(e.slug)}else n.order.push(e.slug)}))),shiftQueue())};export{ValueSubject as V,addOrUpdateProject as a,addOrUpdateManyContents as b,contents$ as c,documents$ as d,addOrUpdateContents as e,getCachedDocument as f,getLastModified as g,queuedDocuments$ as h,fetchingDocuments$ as i,modifyDocument as m,projects$ as p,queueDocument as q,removeContents as r};