var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))__hasOwnProp.call(t,n)&&__defNormalProp(e,n,t[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(t))__propIsEnum.call(t,n)&&__defNormalProp(e,n,t[n]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t));import{k as createSvgIcon,l as interopRequireDefault,r as require$$2,m as generateUtilityClass,n as generateUtilityClasses,o as styled,_ as _extends,p as useThemeProps,q as duration,t as Transition,v as _objectWithoutPropertiesLoose,w as composeClasses,x as useTheme,y as useForkRef,j as jsx,z as clsx,A as getTransitionProps,B as useEnhancedEffect,a as jsxs,D as alpha,E as ownerDocument,F as useId,G as useControlled,I as ButtonBase,J as capitalize,K as useFormControl,L as formControlState,M as getNativeSelectUtilityClasses,N as NativeSelectInput,O as ArrowDropDownIcon,P as Input,Q as useTheme$1,S as getThemeProps,U as default_1$4,V as useParams,W as useObservableAndState,X as projects$,Y as contents$,Z as useObservableState,$ as Box,a0 as FormControl,a1 as InputLabel,a2 as Button,a3 as CircularProgress}from"./main.js";import*as React from"react";import React__default,{Fragment,useState,useCallback,useEffect,useLayoutEffect}from"react";import{combineLatest}from"rxjs";import{map}from"rxjs/operators";import{C as ConditionalCard}from"./conditional_card.js";import{G as Grid}from"./Grid.js";import"react-dom";var ChevronRight={},_interopRequireDefault$3=interopRequireDefault.exports;Object.defineProperty(ChevronRight,"__esModule",{value:!0});var default_1$3=ChevronRight.default=void 0,_createSvgIcon$3=_interopRequireDefault$3(createSvgIcon),_jsxRuntime$3=require$$2,_default$3=(0,_createSvgIcon$3.default)((0,_jsxRuntime$3.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");default_1$3=ChevronRight.default=_default$3;var Close={},_interopRequireDefault$2=interopRequireDefault.exports;Object.defineProperty(Close,"__esModule",{value:!0});var default_1$2=Close.default=void 0,_createSvgIcon$2=_interopRequireDefault$2(createSvgIcon),_jsxRuntime$2=require$$2,_default$2=(0,_createSvgIcon$2.default)((0,_jsxRuntime$2.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");default_1$2=Close.default=_default$2;var ExpandMore={},_interopRequireDefault$1=interopRequireDefault.exports;Object.defineProperty(ExpandMore,"__esModule",{value:!0});var default_1$1=ExpandMore.default=void 0,_createSvgIcon$1=_interopRequireDefault$1(createSvgIcon),_jsxRuntime$1=require$$2,_default$1=(0,_createSvgIcon$1.default)((0,_jsxRuntime$1.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");default_1$1=ExpandMore.default=_default$1;var Menu={},_interopRequireDefault=interopRequireDefault.exports;Object.defineProperty(Menu,"__esModule",{value:!0});var default_1=Menu.default=void 0,_createSvgIcon=_interopRequireDefault(createSvgIcon),_jsxRuntime=require$$2,_default=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu");function getCollapseUtilityClass(e){return generateUtilityClass("MuiCollapse",e)}default_1=Menu.default=_default,generateUtilityClasses("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const _excluded$6=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],useUtilityClasses$4=e=>{const{orientation:t,classes:n}=e;return composeClasses({root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]},getCollapseUtilityClass,n)},CollapseRoot=styled("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],"entered"===n.state&&t.entered,"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&t.hidden]}})((({theme:e,ownerState:t})=>_extends({height:0,overflow:"hidden",transition:e.transitions.create("height")},"horizontal"===t.orientation&&{height:"auto",width:0,transition:e.transitions.create("width")},"entered"===t.state&&_extends({height:"auto",overflow:"visible"},"horizontal"===t.orientation&&{width:"auto"}),"exited"===t.state&&!t.in&&"0px"===t.collapsedSize&&{visibility:"hidden"}))),CollapseWrapper=styled("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})((({ownerState:e})=>_extends({display:"flex",width:"100%"},"horizontal"===e.orientation&&{width:"auto",height:"100%"}))),CollapseWrapperInner=styled("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,t)=>t.wrapperInner})((({ownerState:e})=>_extends({width:"100%"},"horizontal"===e.orientation&&{width:"auto",height:"100%"}))),Collapse=React.forwardRef((function(e,t){const n=useThemeProps({props:e,name:"MuiCollapse"}),{addEndListener:r,children:o,className:a,collapsedSize:s="0px",component:i,easing:l,in:d,onEnter:c,onEntered:u,onEntering:p,onExit:m,onExited:f,onExiting:h,orientation:x="vertical",style:g,timeout:b=duration.standard,TransitionComponent:C=Transition}=n,y=_objectWithoutPropertiesLoose(n,_excluded$6),v=_extends({},n,{orientation:x,collapsedSize:s}),I=useUtilityClasses$4(v),_=useTheme(),R=React.useRef(),w=React.useRef(null),$=React.useRef(),S="number"==typeof s?`${s}px`:s,T="horizontal"===x,j=T?"width":"height";React.useEffect((()=>()=>{clearTimeout(R.current)}),[]);const E=React.useRef(null),P=useForkRef(t,E),k=e=>t=>{if(e){const n=E.current;void 0===t?e(n):e(n,t)}},N=()=>w.current?w.current[T?"clientWidth":"clientHeight"]:0,D=k(((e,t)=>{w.current&&T&&(w.current.style.position="absolute"),e.style[j]=S,c&&c(e,t)})),M=k(((e,t)=>{const n=N();w.current&&T&&(w.current.style.position="");const{duration:r,easing:o}=getTransitionProps({style:g,timeout:b,easing:l},{mode:"enter"});if("auto"===b){const t=_.transitions.getAutoHeightDuration(n);e.style.transitionDuration=`${t}ms`,$.current=t}else e.style.transitionDuration="string"==typeof r?r:`${r}ms`;e.style[j]=`${n}px`,e.style.transitionTimingFunction=o,p&&p(e,t)})),O=k(((e,t)=>{e.style[j]="auto",u&&u(e,t)})),F=k((e=>{e.style[j]=`${N()}px`,m&&m(e)})),z=k(f),U=k((e=>{const t=N(),{duration:n,easing:r}=getTransitionProps({style:g,timeout:b,easing:l},{mode:"exit"});if("auto"===b){const n=_.transitions.getAutoHeightDuration(t);e.style.transitionDuration=`${n}ms`,$.current=n}else e.style.transitionDuration="string"==typeof n?n:`${n}ms`;e.style[j]=S,e.style.transitionTimingFunction=r,h&&h(e)}));return jsx(C,_extends({in:d,onEnter:D,onEntered:O,onEntering:M,onExit:F,onExited:z,onExiting:U,addEndListener:e=>{"auto"===b&&(R.current=setTimeout(e,$.current||0)),r&&r(E.current,e)},nodeRef:E,timeout:"auto"===b?null:b},y,{children:(e,t)=>jsx(CollapseRoot,_extends({as:i,className:clsx(I.root,a,{entered:I.entered,exited:!d&&"0px"===S&&I.hidden}[e]),style:_extends({[T?"minWidth":"minHeight"]:S},g),ownerState:_extends({},v,{state:e}),ref:P},t,{children:jsx(CollapseWrapper,{ownerState:_extends({},v,{state:e}),className:I.wrapper,ref:w,children:jsx(CollapseWrapperInner,{ownerState:_extends({},v,{state:e}),className:I.wrapperInner,children:o})})}))}))}));Collapse.muiSupportAuto=!0;var Collapse$1=Collapse;const TreeViewContext=React.createContext({});var TreeViewContext$1=TreeViewContext;const _excluded$5=["element"];function findIndex(e,t){for(let n=0;n<e.length;n+=1)if(t(e[n]))return n;return-1}function binaryFindElement(e,t){let n=0,r=e.length-1;for(;n<=r;){const o=Math.floor((n+r)/2);if(e[o].element===t)return o;e[o].element.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING?r=o-1:n=o+1}return n}const DescendantContext=React.createContext({});function usePrevious(e){const t=React.useRef(null);return React.useEffect((()=>{t.current=e}),[e]),t.current}const noop=()=>{};function useDescendant(e){const[,t]=React.useState(),{registerDescendant:n=noop,unregisterDescendant:r=noop,descendants:o=[],parentId:a=null}=React.useContext(DescendantContext),s=findIndex(o,(t=>t.element===e.element)),i=usePrevious(o),l=o.some(((e,t)=>i&&i[t]&&i[t].element!==e.element));return useEnhancedEffect((()=>{if(e.element)return n(_extends({},e,{index:s})),()=>{r(e.element)};t({})}),[n,r,s,l,e]),{parentId:a,index:s}}function DescendantProvider(e){const{children:t,id:n}=e,[r,o]=React.useState([]),a=React.useCallback((e=>{let{element:t}=e,n=_objectWithoutPropertiesLoose(e,_excluded$5);o((e=>{let r;if(0===e.length)return[_extends({},n,{element:t,index:0})];const o=binaryFindElement(e,t);if(e[o]&&e[o].element===t)r=e;else{const a=_extends({},n,{element:t,index:o});r=e.slice(),r.splice(o,0,a)}return r.forEach(((e,t)=>{e.index=t})),r}))}),[]),s=React.useCallback((e=>{o((t=>t.filter((t=>e!==t.element))))}),[]),i=React.useMemo((()=>({descendants:r,registerDescendant:a,unregisterDescendant:s,parentId:n})),[r,a,s,n]);return jsx(DescendantContext.Provider,{value:i,children:t})}function useTreeItem(e){const{focus:t,isExpanded:n,isExpandable:r,isFocused:o,isDisabled:a,isSelected:s,multiSelect:i,selectNode:l,selectRange:d,toggleExpansion:c}=React.useContext(TreeViewContext$1),u=!!r&&r(e),p=!!n&&n(e),m=!!o&&o(e),f=!!a&&a(e),h=!!s&&s(e);return{disabled:f,expanded:p,selected:h,focused:m,handleExpansion:r=>{if(!f){m||t(r,e);const o=i&&(r.shiftKey||r.ctrlKey||r.metaKey);!u||o&&n(e)||c(r,e)}},handleSelection:n=>{if(!f){m||t(n,e);i&&(n.shiftKey||n.ctrlKey||n.metaKey)?n.shiftKey?d(n,{end:e}):l(n,e,!0):l(n,e)}},preventSelection:e=>{(e.shiftKey||e.ctrlKey||e.metaKey||f)&&e.preventDefault()}}}const _excluded$4=["classes","className","displayIcon","expansionIcon","icon","label","nodeId","onClick","onMouseDown"],TreeItemContent=React.forwardRef((function(e,t){const{classes:n,className:r,displayIcon:o,expansionIcon:a,icon:s,label:i,nodeId:l,onClick:d,onMouseDown:c}=e,u=_objectWithoutPropertiesLoose(e,_excluded$4),{disabled:p,expanded:m,selected:f,focused:h,handleExpansion:x,handleSelection:g,preventSelection:b}=useTreeItem(l),C=s||a||o;return jsxs("div",_extends({className:clsx(r,n.root,m&&n.expanded,f&&n.selected,h&&n.focused,p&&n.disabled),onClick:e=>{x(e),g(e),d&&d(e)},onMouseDown:e=>{b(e),c&&c(e)},ref:t},u,{children:[jsx("div",{className:n.iconContainer,children:C}),jsx("div",{className:n.label,children:i})]}))}));var TreeItemContent$1=TreeItemContent;function getTreeItemUtilityClass(e){return generateUtilityClass("MuiTreeItem",e)}const treeItemClasses=generateUtilityClasses("MuiTreeItem",["root","group","content","expanded","selected","focused","disabled","iconContainer","label"]);var treeItemClasses$1=treeItemClasses;const _excluded$3=["children","className","collapseIcon","ContentComponent","ContentProps","endIcon","expandIcon","disabled","icon","id","label","nodeId","onClick","onMouseDown","TransitionComponent","TransitionProps"],useUtilityClasses$3=e=>{const{classes:t}=e;return composeClasses({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],label:["label"],group:["group"]},getTreeItemUtilityClass,t)},TreeItemRoot=styled("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(e,t)=>t.root})({listStyle:"none",margin:0,padding:0,outline:0}),StyledTreeItemContent=styled(TreeItemContent$1,{name:"MuiTreeItem",slot:"Content",overridesResolver:(e,t)=>[t.content,t.iconContainer&&{[`& .${treeItemClasses$1.iconContainer}`]:t.iconContainer},t.label&&{[`& .${treeItemClasses$1.label}`]:t.label}]})((({theme:e})=>({padding:"0 8px",width:"100%",display:"flex",alignItems:"center",cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:e.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${treeItemClasses$1.disabled}`]:{opacity:e.palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${treeItemClasses$1.focused}`]:{backgroundColor:e.palette.action.focus},[`&.${treeItemClasses$1.selected}`]:{backgroundColor:alpha(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:alpha(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:alpha(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${treeItemClasses$1.focused}`]:{backgroundColor:alpha(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`& .${treeItemClasses$1.iconContainer}`]:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${treeItemClasses$1.label}`]:_extends({width:"100%",minWidth:0,paddingLeft:4,position:"relative"},e.typography.body1)}))),TreeItemGroup=styled(Collapse$1,{name:"MuiTreeItem",slot:"Group",overridesResolver:(e,t)=>t.group})({margin:0,padding:0,marginLeft:17}),TreeItem=React.forwardRef((function(e,t){const n=useThemeProps({props:e,name:"MuiTreeItem"}),{children:r,className:o,collapseIcon:a,ContentComponent:s=TreeItemContent$1,ContentProps:i,endIcon:l,expandIcon:d,disabled:c,icon:u,id:p,label:m,nodeId:f,onClick:h,onMouseDown:x,TransitionComponent:g=Collapse$1,TransitionProps:b}=n,C=_objectWithoutPropertiesLoose(n,_excluded$3),{icons:y={},focus:v,isExpanded:I,isFocused:_,isSelected:R,isDisabled:w,multiSelect:$,disabledItemsFocusable:S,mapFirstChar:T,unMapFirstChar:j,registerNode:E,unregisterNode:P,treeId:k}=React.useContext(TreeViewContext$1);let N=null;null!=p?N=p:k&&f&&(N=`${k}-${f}`);const[D,M]=React.useState(null),O=React.useRef(null),F=useForkRef(M,t),z=React.useMemo((()=>({element:D,id:f})),[f,D]),{index:U,parentId:V}=useDescendant(z),W=Boolean(Array.isArray(r)?r.length:r),L=!!I&&I(f),A=!!_&&_(f),K=!!R&&R(f),B=!!w&&w(f),q=_extends({},n,{expanded:L,focused:A,selected:K,disabled:B}),H=useUtilityClasses$3(q);let G,Q,J;return W&&(Q=L?a||y.defaultCollapseIcon:d||y.defaultExpandIcon),G=W?y.defaultParentIcon:l||y.defaultEndIcon,React.useEffect((()=>{if(E&&P&&-1!==U)return E({id:f,idAttribute:N,index:U,parentId:V,expandable:W,disabled:c}),()=>{P(f)}}),[E,P,V,U,f,W,c,N]),React.useEffect((()=>{if(T&&j&&m)return T(f,O.current.textContent.substring(0,1).toLowerCase()),()=>{j(f)}}),[T,j,f,m]),$?J=K:K&&(J=!0),jsxs(TreeItemRoot,_extends({className:clsx(H.root,o),role:"treeitem","aria-expanded":W?L:null,"aria-selected":J,"aria-disabled":B||null,ref:F,id:N,tabIndex:-1},C,{ownerState:q,onFocus:function(e){e.target===e.currentTarget&&ownerDocument(e.target).getElementById(k).focus({preventScroll:!0});const t=!S&&B;A||e.currentTarget!==e.target||t||v(e,f)},children:[jsx(StyledTreeItemContent,_extends({as:s,ref:O,classes:{root:H.content,expanded:H.expanded,selected:H.selected,focused:H.focused,disabled:H.disabled,iconContainer:H.iconContainer,label:H.label},label:m,nodeId:f,onClick:h,onMouseDown:x,icon:u,expansionIcon:Q,displayIcon:G,ownerState:q},i)),r&&jsx(DescendantProvider,{id:f,children:jsx(TreeItemGroup,_extends({as:g,unmountOnExit:!0,className:H.group,in:L,component:"ul",role:"group"},b,{children:r}))})]}))}));var TreeItem$1=TreeItem;function getTreeViewUtilityClass(e){return generateUtilityClass("MuiTreeView",e)}generateUtilityClasses("MuiTreeView",["root"]);const _excluded$2=["children","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disabledItemsFocusable","disableSelection","expanded","id","multiSelect","onBlur","onFocus","onKeyDown","onNodeFocus","onNodeSelect","onNodeToggle","selected"],useUtilityClasses$2=e=>{const{classes:t}=e;return composeClasses({root:["root"]},getTreeViewUtilityClass,t)},TreeViewRoot=styled("ul",{name:"MuiTreeView",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:0,margin:0,listStyle:"none",outline:0});function isPrintableCharacter(e){return e&&1===e.length&&e.match(/\S/)}function findNextFirstChar(e,t,n){for(let r=t;r<e.length;r+=1)if(n===e[r])return r;return-1}function noopSelection(){return!1}const defaultDefaultExpanded=[],defaultDefaultSelected=[],TreeView=React.forwardRef((function(e,t){const n=useThemeProps({props:e,name:"MuiTreeView"}),{children:r,className:o,defaultCollapseIcon:a,defaultEndIcon:s,defaultExpanded:i=defaultDefaultExpanded,defaultExpandIcon:l,defaultParentIcon:d,defaultSelected:c=defaultDefaultSelected,disabledItemsFocusable:u=!1,disableSelection:p=!1,expanded:m,id:f,multiSelect:h=!1,onBlur:x,onFocus:g,onKeyDown:b,onNodeFocus:C,onNodeSelect:y,onNodeToggle:v,selected:I}=n,_=_objectWithoutPropertiesLoose(n,_excluded$2),R="rtl"===useTheme().direction,w=_extends({},n,{defaultExpanded:i,defaultSelected:c,disabledItemsFocusable:u,disableSelection:p,multiSelect:h}),$=useUtilityClasses$2(w),S=useId(f),T=React.useRef(null),j=useForkRef(T,t),[E,P]=React.useState(null),k=React.useRef({}),N=React.useRef({}),[D,M]=useControlled({controlled:m,default:i,name:"TreeView",state:"expanded"}),[O,F]=useControlled({controlled:I,default:c,name:"TreeView",state:"selected"}),z=React.useCallback((e=>!!Array.isArray(D)&&-1!==D.indexOf(e)),[D]),U=React.useCallback((e=>k.current[e]&&k.current[e].expandable),[]),V=React.useCallback((e=>Array.isArray(O)?-1!==O.indexOf(e):O===e),[O]),W=React.useCallback((e=>{let t=k.current[e];if(!t)return!1;if(t.disabled)return!0;for(;null!=t.parentId;)if(t=k.current[t.parentId],t.disabled)return!0;return!1}),[]),L=e=>Object.keys(k.current).map((e=>k.current[e])).filter((t=>t.parentId===e)).sort(((e,t)=>e.index-t.index)).map((e=>e.id)),A=e=>{let t=L(e);return u||(t=t.filter((e=>!W(e)))),t},K=e=>{if(z(e)&&A(e).length>0)return A(e)[0];let t=k.current[e];for(;null!=t;){const e=A(t.parentId),n=e[e.indexOf(t.id)+1];if(n)return n;t=k.current[t.parentId]}return null},B=e=>{const t=k.current[e],n=A(t.parentId),r=n.indexOf(e);if(0===r)return t.parentId;let o=n[r-1];for(;z(o)&&A(o).length>0;)o=A(o).pop();return o},q=()=>{let e=A(null).pop();for(;z(e);)e=A(e).pop();return e},H=()=>A(null)[0],G=(e,t)=>{const[n,r]=((e,t)=>{if(e===t)return[e,t];const n=k.current[e],r=k.current[t];if(n.parentId===r.id||r.parentId===n.id)return r.parentId===n.id?[n.id,r.id]:[r.id,n.id];const o=[n.id],a=[r.id];let s=n.parentId,i=r.parentId,l=-1!==a.indexOf(s),d=-1!==o.indexOf(i),c=!0,u=!0;for(;!d&&!l;)c&&(o.push(s),l=-1!==a.indexOf(s),c=null!==s,!l&&c&&(s=k.current[s].parentId)),u&&!l&&(a.push(i),d=-1!==o.indexOf(i),u=null!==i,!d&&u&&(i=k.current[i].parentId));const p=l?s:i,m=L(p),f=o[o.indexOf(p)-1],h=a[a.indexOf(p)-1];return m.indexOf(f)<m.indexOf(h)?[e,t]:[t,e]})(e,t),o=[n];let a=n;for(;a!==r;)a=K(a),o.push(a);return o},Q=(e,t)=>{t&&(P(t),C&&C(e,t))},J=(e,t)=>Q(e,K(t)),X=(e,t=E)=>{let n;n=-1!==D.indexOf(t)?D.filter((e=>e!==t)):[t].concat(D),v&&v(e,n),M(n)},Y=React.useRef(null),Z=React.useRef(!1),ee=React.useRef([]),te=(e,t,n=!1)=>!!t&&(n?((e,t)=>{let n;n=-1!==O.indexOf(t)?O.filter((e=>e!==t)):[t].concat(O),y&&y(e,n),F(n)})(e,t):((e,t)=>{const n=h?[t]:t;y&&y(e,n),F(n)})(e,t),Y.current=t,Z.current=!1,ee.current=[],!0),ne=(e,t,n=!1)=>{const{start:r=Y.current,end:o,current:a}=t;n?((e,t)=>{let n=O.slice();const{start:r,next:o,current:a}=t;o&&a&&(-1===ee.current.indexOf(a)&&(ee.current=[]),Z.current?-1!==ee.current.indexOf(o)?(n=n.filter((e=>e===r||e!==a)),ee.current=ee.current.filter((e=>e===r||e!==a))):(n.push(o),ee.current.push(o)):(n.push(o),ee.current.push(a,o)),y&&y(e,n),F(n))})(e,{start:r,next:o,current:a}):null!=r&&null!=o&&((e,t)=>{let n=O.slice();const{start:r,end:o}=t;Z.current&&(n=n.filter((e=>-1===ee.current.indexOf(e))));let a=G(r,o);a=a.filter((e=>!W(e))),ee.current=a;let s=n.concat(a);s=s.filter(((e,t)=>s.indexOf(e)===t)),y&&y(e,s),F(s)})(e,{start:r,end:o}),Z.current=!0},re=React.useCallback((e=>{const{id:t,index:n,parentId:r,expandable:o,idAttribute:a,disabled:s}=e;k.current[t]={id:t,index:n,parentId:r,expandable:o,idAttribute:a,disabled:s}}),[]),oe=React.useCallback((e=>{const t=_extends({},k.current);delete t[e],k.current=t,P((t=>t===e&&T.current===ownerDocument(T.current).activeElement?L(null)[0]:t))}),[]),ae=React.useCallback(((e,t)=>{N.current[e]=t}),[]),se=React.useCallback((e=>{const t=_extends({},N.current);delete t[e],N.current=t}),[]),ie=e=>(U(E)&&(z(E)?J(e,E):W(E)||X(e)),!0),le=e=>{if(z(E)&&!W(E))return X(e,E),!0;const t=(n=E,k.current[n].parentId);var n;return!!t&&(Q(e,t),!0)},de=k.current[E]?k.current[E].idAttribute:null;return jsx(TreeViewContext$1.Provider,{value:{icons:{defaultCollapseIcon:a,defaultExpandIcon:l,defaultParentIcon:d,defaultEndIcon:s},focus:Q,toggleExpansion:X,isExpanded:z,isExpandable:U,isFocused:e=>E===e,isSelected:V,isDisabled:W,selectNode:p?noopSelection:te,selectRange:p?noopSelection:ne,multiSelect:h,disabledItemsFocusable:u,mapFirstChar:ae,unMapFirstChar:se,registerNode:re,unregisterNode:oe,treeId:S},children:jsx(DescendantProvider,{children:jsx(TreeViewRoot,_extends({role:"tree",id:S,"aria-activedescendant":de,"aria-multiselectable":h,className:clsx($.root,o),ref:j,tabIndex:0,onKeyDown:e=>{let t=!1;const n=e.key;if(e.altKey||e.currentTarget!==e.target||!E)return;const r=e.ctrlKey||e.metaKey;switch(n){case" ":p||W(E)||(h&&e.shiftKey?(ne(e,{end:E}),t=!0):t=h?te(e,E,!0):te(e,E)),e.stopPropagation();break;case"Enter":W(E)||U(E)&&(X(e),t=!0),e.stopPropagation();break;case"ArrowDown":h&&e.shiftKey&&!p&&((e,t)=>{W(K(t))||ne(e,{end:K(t),current:t},!0)})(e,E),J(e,E),t=!0;break;case"ArrowUp":h&&e.shiftKey&&!p&&((e,t)=>{W(B(t))||ne(e,{end:B(t),current:t},!0)})(e,E),((e,t)=>{Q(e,B(t))})(e,E),t=!0;break;case"ArrowRight":t=R?le(e):ie(e);break;case"ArrowLeft":t=R?ie(e):le(e);break;case"Home":h&&r&&e.shiftKey&&!p&&!W(E)&&((e,t)=>{Y.current||(Y.current=t);const n=Z.current?Y.current:t;ne(e,{start:n,end:H()})})(e,E),(e=>{Q(e,H())})(e),t=!0;break;case"End":h&&r&&e.shiftKey&&!p&&!W(E)&&((e,t)=>{Y.current||(Y.current=t);const n=Z.current?Y.current:t;ne(e,{start:n,end:q()})})(e,E),(e=>{Q(e,q())})(e),t=!0;break;default:"*"===n?(((e,t)=>{const n=k.current[t],r=L(n.parentId).filter((e=>U(e)&&!z(e))),o=D.concat(r);r.length>0&&(M(o),v&&v(e,o))})(e,E),t=!0):h&&r&&"a"===n.toLowerCase()&&!p?((e=>{ne(e,{start:H(),end:q()})})(e),t=!0):r||e.shiftKey||!isPrintableCharacter(n)||(((e,t,n)=>{let r,o;const a=n.toLowerCase(),s=[],i=[];Object.keys(N.current).forEach((e=>{const t=N.current[e],n=k.current[e],r=!n.parentId||z(n.parentId),o=!u&&W(e);r&&!o&&(s.push(e),i.push(t))})),r=s.indexOf(t)+1,r>=s.length&&(r=0),o=findNextFirstChar(i,r,a),-1===o&&(o=findNextFirstChar(i,0,a)),o>-1&&Q(e,s[o])})(e,E,n),t=!0)}t&&(e.preventDefault(),e.stopPropagation()),b&&b(e)},onFocus:e=>{if(e.target===e.currentTarget){const t=Array.isArray(O)?O[0]:O;Q(e,t||A(null)[0])}g&&g(e)},onBlur:e=>{P(null),x&&x(e)},ownerState:w},_,{children:r}))})})}));var TreeView$1=TreeView;function getFabUtilityClass(e){return generateUtilityClass("MuiFab",e)}const fabClasses=generateUtilityClasses("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge"]);var fabClasses$1=fabClasses;const _excluded$1=["children","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"],useUtilityClasses$1=e=>{const{color:t,variant:n,classes:r,size:o}=e,a={root:["root",n,`size${capitalize(o)}`,"inherit"===t&&"colorInherit","primary"===t&&"primary","secondary"===t&&"secondary"]};return composeClasses(a,getFabUtilityClass,r)},FabRoot=styled(ButtonBase,{name:"MuiFab",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`size${capitalize(n.size)}`],"inherit"===n.color&&t.colorInherit,"primary"===n.color&&t.primary,"secondary"===n.color&&t.secondary]}})((({theme:e,ownerState:t})=>_extends({},e.typography.button,{minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,boxShadow:e.shadows[6],"&:active":{boxShadow:e.shadows[12]},color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],"&:hover":{backgroundColor:e.palette.grey.A100,"@media (hover: none)":{backgroundColor:e.palette.grey[300]},textDecoration:"none"},[`&.${fabClasses$1.focusVisible}`]:{boxShadow:e.shadows[6]},[`&.${fabClasses$1.disabled}`]:{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground}},"small"===t.size&&{width:40,height:40},"medium"===t.size&&{width:48,height:48},"extended"===t.variant&&{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48},"extended"===t.variant&&"small"===t.size&&{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34},"extended"===t.variant&&"medium"===t.size&&{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40},"inherit"===t.color&&{color:"inherit"})),(({theme:e,ownerState:t})=>_extends({},"primary"===t.color&&{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},"secondary"===t.color&&{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}}))),Fab=React.forwardRef((function(e,t){const n=useThemeProps({props:e,name:"MuiFab"}),{children:r,className:o,color:a="default",component:s="button",disabled:i=!1,disableFocusRipple:l=!1,focusVisibleClassName:d,size:c="large",variant:u="circular"}=n,p=_objectWithoutPropertiesLoose(n,_excluded$1),m=_extends({},n,{color:a,component:s,disabled:i,disableFocusRipple:l,size:c,variant:u}),f=useUtilityClasses$1(m);return jsx(FabRoot,_extends({className:clsx(f.root,o),component:s,disabled:i,focusRipple:!l,focusVisibleClassName:clsx(f.focusVisible,d),ownerState:m,ref:t},p,{children:r}))}));var Fab$1=Fab;const _excluded=["className","children","classes","IconComponent","input","inputProps","variant"],_excluded2=["root"],useUtilityClasses=e=>{const{classes:t}=e;return composeClasses({root:["root"]},getNativeSelectUtilityClasses,t)},defaultInput=jsx(Input,{}),NativeSelect=React.forwardRef((function(e,t){const n=useThemeProps({name:"MuiNativeSelect",props:e}),{className:r,children:o,classes:a={},IconComponent:s=ArrowDropDownIcon,input:i=defaultInput,inputProps:l}=n,d=_objectWithoutPropertiesLoose(n,_excluded),c=useFormControl(),u=formControlState({props:n,muiFormControl:c,states:["variant"]}),p=_extends({},n,{classes:a}),m=useUtilityClasses(p),f=_objectWithoutPropertiesLoose(a,_excluded2);return React.cloneElement(i,_extends({inputComponent:NativeSelectInput,inputProps:_extends({children:o,classes:f,IconComponent:s,variant:u.variant,type:void 0},l,i?i.props.inputProps:{}),ref:t},d,{className:clsx(m.root,i.props.className,r)}))}));NativeSelect.muiName="Select";var NativeSelect$1=NativeSelect;function useMediaQuery(e,t={}){const n=useTheme$1(),r="undefined"!=typeof window&&void 0!==window.matchMedia,{defaultMatches:o=!1,matchMedia:a=(r?window.matchMedia:null),noSsr:s=!1,ssrMatchMedia:i=null}=getThemeProps({name:"MuiUseMediaQuery",props:t,theme:n});let l="function"==typeof e?e(n):e;l=l.replace(/^@media( ?)/m,"");const[d,c]=React.useState((()=>s&&r?a(l).matches:i?i(l).matches:o));return useEnhancedEffect((()=>{let e=!0;if(!r)return;const t=a(l),n=()=>{e&&c(t.matches)};return n(),t.addListener(n),()=>{e=!1,t.removeListener(n)}}),[l,a,r]),d}const RenderTree=React__default.memo((({content:e})=>{const t=e=>e.map((e=>jsx(TreeItem$1,{nodeId:e.slug,label:e.name,children:t(e.children)},e.slug)));return jsx(Fragment,{children:e.map((e=>jsx(TreeItem$1,{nodeId:e.slug,label:e.name,children:t(e.children)},e.slug)))})})),createTree=(e,t)=>{const n={depth:-1,parent:null,children:[]};let r=n;return e.forEach((e=>{const t=e.depth,n=__spreadProps(__spreadValues({},e),{depth:t,children:[],parent:null});if(t<=r.depth)for(;t<=r.depth;)r=r.parent;n.parent=r,r.children.push(n),r=n})),n.children},SidebarWrapper=default_1$4(Grid)((({theme:e})=>({flexGrow:1,maxWidth:400,position:"sticky",top:60,"&.editor-sidebar":{top:0,padding:"10px",display:"block",width:"200px"},"&:not(.edit-sidebar) > .MuiPaper-root":{maxHeight:"calc(100vh - 180px)",overflow:"auto"},".menu-button":{display:"none",position:"fixed",right:20,bottom:20},".MuiTreeItem-label":{paddingTop:"0.25em",paddingBottom:"0.25em",lineHeight:"1.3em !important",wordBreak:"break-word"},[e.breakpoints.down("sm")]:{paddingRight:20,display:"flex",alignItems:"center",justifyContent:"flex-start",flexDirection:"column",position:"fixed",top:"55px",width:"100%",maxWidth:"100%",flexBasis:"initial",height:"0%",padingRight:"10px",backgroundColor:"light"===e.palette.mode?"#fff":"#1c2128",overflow:"hidden",transition:"height .3s ease","&.show":{height:"100%"}," .menu-button":{display:"flex"},"& > * > *":{width:"100%"},"ul *, form *, .MuiBox-root *":{fontSize:"1.2rem !important"}}}))),RenderTreeWrapper=({projectObservable$:e})=>{const[t]=useObservableState((()=>combineLatest([contents$,e]).pipe(map((([e,t])=>{try{return createTree(e.get(t.slug))}catch(e){return}})))));return t?jsx(RenderTree,{content:t}):jsx(CircularProgress,{})};function Sidebar({onNodeSelect:e,mode:t,onProjectSelect:n}){const[r,o]=useState([]),a=useParams(),[s]=useObservableAndState((()=>projects$)),[i,l]=useObservableAndState((e=>combineLatest(projects$,e).pipe(map((([e,[t]])=>e.get(t))))),[a.projectSlug]),d=useCallback((()=>{i&&o((e=>0===e.length?Array.from(contents$.value.get(i.slug).values()).map((e=>e.slug)):[]))}),[i]),c=useObservableState(contents$);useEffect((()=>{if(i){const e=c.get(i.slug);e&&o(Array.from(e.values()).map((e=>e.slug)))}}),[i,c]);const u=useMediaQuery(useTheme().breakpoints.down("sm")),[p,m]=useState(!1);return useLayoutEffect((()=>{u||m(!1)}),[u]),jsx(SidebarWrapper,{item:!0,xs:3,className:(p?"show":"")+" "+("editor"===t?"editor-sidebar":"docs-sidebar"),children:jsxs(ConditionalCard,{showCard:"docs"===t,sx:{padding:2,position:"sticky",top:"80px"},children:[jsx(Fab$1,{color:"secondary","aria-label":"add",className:"menu-button",children:p?jsx(default_1$2,{onClick:()=>m(!1)}):jsx(default_1,{onClick:()=>m(!0)})}),s.size>1&&jsx(Box,{sx:{mb:1},children:jsxs(FormControl,{fullWidth:!0,children:[jsx(InputLabel,{variant:"standard",htmlFor:"uncontrolled-native",children:"Project"}),i&&jsx(NativeSelect$1,{defaultValue:i.slug,inputProps:{name:"age",id:"uncontrolled-native"},onChange:e=>{n(e.target.value)},children:Array.from(s).map((([e,t])=>jsx("option",{value:e,children:t.name},e)))})]})}),jsx(Box,{sx:{mb:1},children:jsx(Button,{onClick:d,children:0===r.length?"Expand all":"Collapse all"})}),a.contentSlug&&jsx(TreeView$1,{"aria-label":"controlled",defaultCollapseIcon:jsx(default_1$1,{}),defaultExpandIcon:jsx(default_1$3,{}),expanded:r,onNodeToggle:(e,t)=>{"svg"===e.target.tagName&&o(t)},onNodeSelect:(t,n)=>{"svg"!==t.target.tagName&&e(n)},selected:"editor"!==t?a.contentSlug:"",children:jsx(RenderTreeWrapper,{projectObservable$:l})})]})})}export{Sidebar,Sidebar as default};